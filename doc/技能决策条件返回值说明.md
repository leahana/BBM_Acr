# 技能决策条件返回值说明
- **文档名称**: 技能 `Check` 方法设计文档
- **作者**: BBM
- **创建日期**: 2024-01-03
- **版本**: v1.0


## 1 返回值分类
技能 `Check` 方法返回值根据含义分为以下几类：

### **1.1 通用返回值**
适用于所有技能的通用逻辑，包括技能冷却、资源不足等问题。
- **负数返回值**：
  - 表示技能未满足释放条件。
- **零值**：
  - 条件接近满足但优先级较低（一般默认条件最后返回为0）。
- **正数返回值**：
  - 技能满足条件，值越大优先级越高（仅作为调试信息）。

### **1.2 模块特有返回值¥**
适用于特定模块的逻辑检查，例如 QT 检查、时间轴触发条件等：
- **QT 模块**：返回值范围 `-100` 至 `-199`。
- **时间轴模块**：返回值范围 `-200` 至 `-299`。

## 2. 返回值定义

| **范围**        | **模块**              | **含义**                                           |
|:----------------:|:---------------------:|---------------------------------------------------|
| `-1` ～ `-99`  | 通用                 | 技能状态、条件不满足                              |
| `-100` 至 `-199` | QT 模块              | QT 条件不满足或冲突                               |
| `-200～ `-299` | 时间轴触发模块       | 时间轴条件不满足或冲突                            |
| `0`              | 通用                 | 接近满足，(所有Qt判断通过)           |
| `1` ～ `99`      | 通用                 | 技能条件满足，                           |
| `100` ～ `199`   | QT 模块          | 技能条件满足，                        |
| `200` ～    | 扩展                 | 预留给未来扩展模块（如团队增益触发、环境检测等） |

---

## 3. 返回值说明

默认情况下 表格从上而下顺序为判断顺序，会有满足qt等提前返回的情况。比如 弹射/将死 判断 qt通过0后不会立即返回还会判断前一次能力技是否为弹射/将死。再进行返回，防止出现Gcd+双插两次将死

### 3.1 通用部分

| **范围**        | **模块**              | **含义**                                           |
|:-----------------|:----------------------|---------------------------------------------------|
| `-1`  | 通用                 | 技能未准备好                      |
| `-2` | 通用        | GCD  不可插入(默认600ms) |
| -199 | Qt | 未配置qt 调用CheckQt |
| 0 | 通用 | 所有qt通过 |
| 1 | 通用 | 所有条件技能满足可用 且Qt通过 |

### 3.2 OffGCD决策Slot



#### 3.2.1 MchAbilityBarrelStabilizer

> 枪管加热决策

| **范围**        | **含义**                                           | **模块**              |
|:-----------------|---------------------------------------------------|:----------------------|
| `-1`  | 技能未准备好                      | 通用                 |
| `-2` | GCD  不可插入             | 通用        |
| 101/-101 | Qt"爆发"设置 开启/关闭 | Qt模块 |



#### 3.2.2 MchAbilityCheckMate

> 弹射/将死决策

| **范围**   | **含义**                                                     | **模块**      |
| ---------- | :----------------------------------------------------------- | :------------ |
| `-1`       | 技能未准备好                                                 | 通用          |
| `-2`       | GCD  不可插入                                                | 通用          |
| `101/-101` | Qt"爆发" 开启/关闭                                           | Qt            |
| `-145/145` | Qt"保留2层将死" 开启/关闭（保留所以取反）                    | Qt            |
| `3/-3`     | 过热状态/将死>双将层数                                       | 弹射/将死决策 |
| `4/-4`     | 默认 层数大于1且上一个能力技不是本身（防止出现gcd双插两次将死） | 弹射/将死决策 |



#### 3.2.3 MchAbilityDoubleCheck

> 虹吸弹/双将决策

| **范围**   | **含义**                                                     | **模块**      |
| ---------- | :----------------------------------------------------------- | :------------ |
| `-1`       | 技能未准备好                                                 | 通用          |
| `-2`       | GCD  不可插入                                                | 通用          |
| `101/-101` | Qt"爆发" 开启/关闭                                           | Qt            |
| `-146/146` | Qt"保留2层双将" 开启/关闭（保留所以取反）                    | Qt            |
| `3/-3`     | 过热状态/双将>将死层数                                       | 虹吸/双将决策 |
| `4/-4`     | 默认 层数大于1且上一个能力技不是本身（防止出现gcd双插两次双将） | 虹吸/双将决策 |



#### 3.2.4 MchAbilityHyperCharge

> 超荷决策

| **范围**   | **含义**                                 | **模块** |
| ---------- | :--------------------------------------- | :------- |
| `-1`       | 技能未准备好                             | 通用     |
| `-2`       | GCD  不可插入                            | 通用     |
| `-3`       | 连击在0-9.5s不打超荷防止断连击           | 超荷决策 |
| `-4`       | 热量小于50 且没有超荷预备                | 超荷决策 |
| `-5`       | 三大件还有8s转好 空气锚/飞锯/钻头1.6层   | 超荷决策 |
| `-6`       | 120快好了，35s内枪管加热转好 热量小于100 | 超荷决策 |
| `-7`       | 全金属爆发或者飞轮预备                   | 超荷决策 |
| `101/-101` | Qt"爆发" 开启/关闭                       | Qt       |
| `111/-111` | Qt“超荷” 开启/关闭                       | Qt       |
| `2`        | 有超荷预备且野火转好了                   | 超荷决策 |
| `1`        | 热量大于50                               | 超荷决策 |



#### 3.2.5 MchAbilityReassemble

> 整备决策

| **范围**   | **含义**                                      | **模块** |
| ---------- | :-------------------------------------------- | :------- |
| `-1`       | 技能未准备好                                  | 通用     |
| `-2`       | GCD  不可插入                                 | 通用     |
| `-3`       | 已经有整备状态                                | 整备决策 |
| `-4`       | 1.2s内使用过整备                              | 整备决策 |
| `-5`       | 下一个Gcd不是三大件                           | 整备决策 |
| `-6`       | 强威力 GCD 是 HotShot                         | 整备决策 |
| `-7`       | 当前处于过热状态                              | 整备决策 |
| `101/-101` | Qt"爆发" 开启/关闭                            | Qt       |
| `112/-112` | Qt"整备"开启/关闭                             | Qt       |
| `1`        | 野火没好                                      | 整备决策 |
| `2`        | Gcd是钻头/空气锚                              | 整备决策 |
| `-8`       | 强威力为回转飞锯被 检查空气矛和钻头是否准备好 | 整备决策 |
| `-9`       | 上一个技能是野火不用整备                      | 整备决策 |
| 0          | 以上所有决策通过并且没有提前返回              | 整备决策 |


#### 3.2.6 MchAbilityUseBattery
> 电量决策

| **范围** | **含义**                   | **模块** |
| -------- | :------------------------- | :------- |
| `-1`     | 技能未准备好               | 通用     |
| `-2`     | GCD  不可插入              | 通用     |
| `-3`     | 已经有机器人               | 整备决策 |
| `-4`     | 处于过热状态               | 整备决策 |
| `-5`     | 超负荷技能最近1200ms使用过 | 整备决策 |
| `-6`     | 召唤技能的剩余时间>0       | 整备决策 |
| `-7`     | 电量小于50                 | 整备决策 |
| `-8`     | 电量小于用户预设值         | 整备决策 |
| `1`      | 电量大于用户预设值         | 整备决策 |



#### 3.2.7 MchAbilityWildfire
> 野火决策

| **范围**   | **含义**        | **模块** |
| ---------- | :-------------- | :------- |
| `-1`       | 技能未准备好    | 通用     |
| `-2`       | GCD  不可插入   | 通用     |
| `-3`       | 双将将死都为3层 | 野火决策 |
| `-4`       | 不在过热状态    | 野火决策 |
| `101/-101` | 爆发Qt开/关     | Qt       |
| `113/-113` | 野火Qt开/关     | Qt       |





### 3.3 Gcd决策Slot

#### 3.3.1 MchGcdBlazingShot

> 烈焰弹/热冲击 决策

| **范围**   | **含义**                      | **模块**   |
| ---------- | :---------------------------- | :--------- |
| `-123/123` | 在过热状态，强制123 开启 关闭 | Qt         |
| `-1`       | 不在过热状态                  | 空气矛决策 |




#### 3.3.2 MchGcdAirAnchor 
> 空气锚决策

| **范围**   | **含义**                         | **模块**   |
| ---------- | :------------------------------- | :--------- |
| `-1`       | 技能未准备好                     | 通用       |
| `-3`       | 防止断连击 123连击中且上一G不是3 | 空气矛决策 |
| `-4`       | 可打Gcd且空气锚CD超过 1.2s       | 空气矛决策 |
| `101/-101` | 爆发Qt  开启/关闭                | Qt         |
| `-123/123` | 强制123 开启/关闭                | Qt         |
| `151/-151` | 空气锚Qt 开启/关闭               | Qt         |




#### 3.3.3 MchGcdChainSaw

> 回转飞锯

| **范围**   | **含义**                         | **模块**   |
| ---------- | :------------------------------- | :--------- |
| `-1`       | 技能未准备好                     | 通用       |
| `-3`       | 防止断连击 123连击中且上一G不是3 | 回转飞锯决策 |
| `-4`       | 空气锚还有1.2s转好 | 回转飞锯决策 |
| `-5`         | 回转飞锯还有1.2s转好             | 回转飞锯决策 |
| `-6` | gcd不可用且钻头小于1层 | 回转飞锯决策 |
| `101/-101` | 爆发Qt  开启/关闭    | Qt         |
| `-123/123` | 强制123 开启/关闭 | Qt |
| `152/-152` | 钻头Qt 开启/关闭 | Qt |



#### 3.3.4 MchGcdExcavator

>掘地飞轮决策

| **范围**   | **含义**                         | **模块**   |
| ---------- | :------------------------------- | :--------- |
| `-1`       | 技能未准备好                     | 通用       |
| `-3`       | 防止断连击 123连击中且上一G不是3 | 钻头决策 |
| `-4`       | 空气锚还有1.2s转好 | 钻头决策 |
| `101/-101` | 爆发Qt  开启/关闭    | Qt         |
| `-123/123` | 强制123 开启/关闭 | Qt |
| `163/-163` | 飞轮Qt 开启/关闭 | Qt |




#### 3.3.5 MchGcdDrill

> 钻头决策

| **范围**   | **含义**                         | **模块**   |
| ---------- | :------------------------------- | :--------- |
| `-1`       | 技能未准备好                     | 通用       |
| `-3`       | 防止断连击 123连击中且上一G不是3 | 钻头决策 |
| `-4`       | 空气锚还有1.2s转好 | 钻头决策 |
| `-5`         | 回转飞锯还有1.2s转好             | 钻头决策     |
| `-6` | gcd不可用且钻头小于1层 | 钻头决策     |
| `101/-101` | 爆发Qt  开启/关闭    | Qt         |
| `-123/123` | 强制123 开启/关闭 | Qt |
| `152/-152` | 钻头Qt 开启/关闭 | Qt |




#### 3.3.6 MchGcdFullMetalField

> 全金属爆发决策

| **范围**   | **含义**                         | **模块**   |
| ---------- | :------------------------------- | :--------- |
| `-1`       | 技能未准备好                     | 通用       |
| `-3`       | 没有全金属爆发状态预备状态 | 钻头决策 |
| `-4`       | 空气锚还有1.2s转好 | 钻头决策 |
| `101/-101` | 爆发Qt  开启/关闭 | Qt |
| `-123/123` | 强制123 开启/关闭 | Qt |
| `161/-161` | 全金属爆发Qt  开启/关闭 | Qt |















